version: '3.3'
services:
        rabbitmq:
                image: rabbitmq:latest
                environment:
                        RABBITMQ_DEFAULT_USER: celery
                        RABBITMQ_DEFAULT_PASS: pw123456
                        RABBITMQ_DEFAULT_VHOST: celery_vhost
                ports:
                        - "5672:5672"
                        - "15672:15672"
        celery:
                build: ./celery
                command: celery -A crawler work -l info
                restart: always
                depends_on:
                        - rabbitmq
        app:
                build: ./django
                command: sh build.sh
                restart: always
                ports:
                        - "80:8000"
                volumes:
                        - .:/nicetomeetyou
                depends_on:
                        - rabbitmq

